#!/bin/zsh

download_url="https://bdsm.beginrescueend.com"
releases_url="releases"

remote_path="$download_url/$releases_url"

version=$(curl "$remote_path/latest.txt")
sm_path="sm-$version"
archive="$sm_path.tar.bz2"

remote_file="$remote_path/$archive"
install_cmd="$sm_path/bin/sm-installer"

curl -O $remote_file

[[ -f $archive ]] && tar jxf $archive

[[ -f $install_cmd ]] && bash $install_cmd

[[ -d $HOME/.sm ]] && 
  rm -rf ./$sm_path &&
  mv $archive $HOME/.sm/archives/
